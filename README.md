Project Name: Credit Card Fraud Detection <br>
Author Name: Siddhant Sinha <br>
Project Date: 2nd Week of March 2020
<br>
<br>
Introduction
<br> <br>
Credit card fraud detection is an important application of Data Science and Machine Learning. Banks use various algorithms to detect fraudulent transcation/ or to detect transcation that require further scrutiny. In this project, I presented a few models based on Machine Learning in order to detect fraudulent transaction based on customer profile.
<br>
Dataset can be found here. https://www.kaggle.com/mlg-ulb/creditcardfraud
<br>
About the data
<br>
This data has several fields<br>
Time - Number of seconds elapsed between each transaction and the first transaction in the dataset<br>
Amount - Transaction Amount<br>
Features V1-V28 which have been generated by Principal Componenent Analysis, so there is no need to know what these features actually are. <br>
<br>
Data Preprocessing<br> <br>
First of all, an important thing to note is that Data is highly skewed - there are 284315 data points for legitimate transaction, and only 492 data points of fraudulent transaction.
<br>
Solution - Undersampling - I have randomly selected 492 data points out of all the data points for legitimate transaction, along with 492 data points for fraudulent transaction. This makes total data on which Models will be trained = 984
<br>
Further, Standard scalar has been applied so that data has a mean of 0 and a standard deviation of 1.0
<br>
Lastly, 20% of data has been split into test set, and remaining is training set.
<br> <br>
Goal
<br> <br>
The goal is to detect most of the frauduent cases and get a high F-1 score for that. Even, if there are false positives, [Model detecting legit transaction as fraudulent] it is fine as all the cases detected by the model as fraud generally go manual evaluation as well. However, other way round (Missing fraud transaction) can be extremely risky. Hence, it is preferable to trade F-1 score for fraud cases for overall accuracy of the model.
<br> <br>
Models used - [Please refer code for details about the model, here I am presenting results and making a comparision] <br> <br>
1. <b> Logistic Regression: </b> <br>
   Overall Accuracy - 94% <br>
   F-1 Score for fraud cases - 0.93 <br>
   F-1 Score for legitimate cases - 0.94 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 1 <br>
   Number of legit cases detected correctly - 101 <br>
   <br>
   
2. <b> Decision Tree [Depth=4]: </b> <br>
   Overall Accuracy - 93% <br>
   F-1 Score for fraud cases - 0.93 <br>
   F-1 Score for legitimate cases - 0.94 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
2. <b> Decision Tree [Depth=5]: </b> <br>
   Overall Accuracy - 93% <br>
   F-1 Score for fraud cases - 0.93 <br>
   F-1 Score for legitimate cases - 0.94 <br>
   Number of fraud cases detected as legit - <b> 8 </b> <br>
   Number of fraud cases detected correctly - 87 <br>
   Number of legit cases detected as fraud - 5 <br>
   Number of legit cases detected correctly - 97 <br>
   <br>
3. <b> Decision Tree [Depth=6]: </b> <br>
   Overall Accuracy - 92% <br>
   F-1 Score for fraud cases - 0.92 <br>
   F-1 Score for legitimate cases - 0.93 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 4 <br>
   Number of legit cases detected correctly - 98 <br>
   <br>
4. <b> Decision Tree [Depth=7]: </b> <br>
   Overall Accuracy - 93% <br>
   F-1 Score for fraud cases - 0.92 <br>
   F-1 Score for legitimate cases - 0.93 <br>
   Number of fraud cases detected as legit - <b> 10 </b> <br>
   Number of fraud cases detected correctly - 85 <br>
   Number of legit cases detected as fraud - 4 <br>
   Number of legit cases detected correctly - 98 <br>
   <br>
5. <b> Decision Tree [Depth=8]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.91 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 10 </b> <br>
   Number of fraud cases detected correctly - 85 <br>
   Number of legit cases detected as fraud - 7 <br>
   Number of legit cases detected correctly - 95 <br>
   <br>
6. <b> Decision Tree [Depth=9]: </b> <br>
   Overall Accuracy - 92% <br>
   F-1 Score for fraud cases - 0.92 <br>
   F-1 Score for legitimate cases - 0.93 <br>
   Number of fraud cases detected as legit - <b> 10 </b> <br>
   Number of fraud cases detected correctly - 85 <br>
   Number of legit cases detected as fraud - 7 <br>
   Number of legit cases detected correctly - 95 <br>
   <br>
7. <b> Decision Tree [Depth=10]: </b> <br>
   Overall Accuracy - 92% <br>
   F-1 Score for fraud cases - 0.92 <br>
   F-1 Score for legitimate cases - 0.93 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 4 <br>
   Number of legit cases detected correctly - 98 <br>
   <br>
8. <b> Decision Tree [Depth=8]: </b> <br>
   Overall Accuracy - 93% <br>
   F-1 Score for fraud cases - 0.93 <br>
   F-1 Score for legitimate cases - 0.94 <br>
   Number of fraud cases detected as legit - <b> 10 </b> <br>
   Number of fraud cases detected correctly - 85 <br>
   Number of legit cases detected as fraud - 7 <br>
   Number of legit cases detected correctly - 95 <br>
   <br>
9. <b> Support vector Machine [Kernel=rbf]: </b> <br>
   Overall Accuracy - 93% <br>
   F-1 Score for fraud cases - 0.92 <br>
   F-1 Score for legitimate cases - 0.94 <br>
   Number of fraud cases detected as legit - <b> 13 </b> <br>
   Number of fraud cases detected correctly - 82 <br>
   Number of legit cases detected as fraud - 1 <br>
   Number of legit cases detected correctly - 101 <br>
   <br>
10. <b> Support vector Machine [Kernel=poly, degree=2]: </b> <br>
   Overall Accuracy - 78% <br>
   F-1 Score for fraud cases - 0.71 <br>
   F-1 Score for legitimate cases - 0.82 <br>
   Number of fraud cases detected as legit - <b> 42 </b> <br>
   Number of fraud cases detected correctly - 53 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
11. <b> Support vector Machine [Kernel=poly, degree=3]: </b> <br>
   Overall Accuracy - 88% <br>
   F-1 Score for fraud cases - 0.86 <br>
   F-1 Score for legitimate cases - 0.90 <br>
   Number of fraud cases detected as legit - <b> 23 </b> <br>
   Number of fraud cases detected correctly - 72 <br>
   Number of legit cases detected as fraud - 0 <br>
   Number of legit cases detected correctly - 102 <br>
   <br>
12. <b> Support vector Machine [Kernel=linear]: </b> <br>
   Overall Accuracy - 94% <br>
   F-1 Score for fraud cases - 0.94 <br>
   F-1 Score for legitimate cases - 0.95 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 0 <br>
   Number of legit cases detected correctly - 102 <br>
   <br>
13. <b> KNN [k=2]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 15 </b> <br>
   Number of fraud cases detected correctly - 80 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
14. <b> KNN [k=3]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 15 </b> <br>
   Number of fraud cases detected correctly - 80 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>  
15. <b> KNN [k=4]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 17 </b> <br>
   Number of fraud cases detected correctly - 78 <br>
   Number of legit cases detected as fraud - 1 <br>
   Number of legit cases detected correctly - 101 <br>
   <br>
16. <b> KNN [k=5]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 15 </b> <br>
   Number of fraud cases detected correctly - 80 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
17. <b> KNN [k=6]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 16 </b> <br>
   Number of fraud cases detected correctly - 79 <br>
   Number of legit cases detected as fraud - 1 <br>
   Number of legit cases detected correctly - 101 <br>
   <br>
18. <b> KNN [k=7]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 15 </b> <br>
   Number of fraud cases detected correctly - 80 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
19. <b> K-means [k=2]: </b> <br>
   Overall Accuracy - 91% <br>
   F-1 Score for fraud cases - 0.90 <br>
   F-1 Score for legitimate cases - 0.92 <br>
   Number of fraud cases detected as legit - <b> 15 </b> <br>
   Number of fraud cases detected correctly - 80 <br>
   Number of legit cases detected as fraud - 2 <br>
   Number of legit cases detected correctly - 100 <br>
   <br>
20. <b> Random Forest [iterations=100]: </b> <br>
   Overall Accuracy - 94% <br>
   F-1 Score for fraud cases - 0.94 <br>
   F-1 Score for legitimate cases - 0.95 <br>
   Number of fraud cases detected as legit - <b> 11 </b> <br>
   Number of fraud cases detected correctly - 84 <br>
   Number of legit cases detected as fraud - 0 <br>
   Number of legit cases detected correctly - 102 <br>
   <br>
   
Result <br>
Clearly, the best solution out of all the model is Decision Tree with depth=5, as it failed only on 8 fraudulent cases. You may notive that it has even failed on 5 legitimate cases, which is more that few other models, but this is not an issue. Further, there are Logistic Regression, other decision tree, and random forest models are showing almost the same result. K-means and KNN are not a good choice, as they are failing on upto 15 cases. Reason for this maybe because they are unsupervised learning algorithms, and supervised algos might have an edge over here because of available true classes. Lastly, SVM machine is not a good choice (especially is kernel is chosen to be polynomial). It is giving 40+ incorrect predictions and the reason my be unavailability of "non-linearlity" in the data for the model to fit. SVM with kernel = linear/rbf is still okay and the results are comparable to random forest/ logistic regression.
<br>
<br>
There are many novel approaches for this task using Artificial Neural Networks and ensemble learning, which I haven't covered in this project <br>
For any queries, I can be contacted at sid.ronaldo1904@gmail.com <br>
Siddhant Sinha
